<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Good and sad examples of extension functions - Cups of Code</title><link rel=apple-touch-icon href=https://cupsofcode.com/images/favicons/logo.svg sizes=180x180><link rel=icon href=https://cupsofcode.com/images/favicons/logo.svg sizes=32x32 type=image/png><link rel=icon href=https://cupsofcode.com/images/favicons/logo.svg sizes=16x16 type=image/png><link rel=manifest href=https://cupsofcode.com/images/favicons/manifest.json><link rel=icon href=https://cupsofcode.com/images/favicons/logo.svg><meta name=keywords content><meta name=description content="Common practices of writing extension functions in Kotlin"><meta itemprop=name content="Good and sad examples of extension functions"><meta itemprop=description content="Common practices of writing extension functions in Kotlin"><meta itemprop=datePublished content="2019-12-29T00:00:00+00:00"><meta itemprop=dateModified content="2019-12-29T00:00:00+00:00"><meta itemprop=wordCount content="1049"><meta itemprop=image content="https://cupsofcode.com/images/speakers.jpg"><meta itemprop=keywords content="android,kotlin,"><meta property="og:title" content="Good and sad examples of extension functions"><meta property="og:description" content="Common practices of writing extension functions in Kotlin"><meta property="og:type" content="article"><meta property="og:url" content="https://cupsofcode.com/post/good-and-sad-extensions/"><meta property="og:image" content="https://cupsofcode.com/images/speakers.jpg"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-12-29T00:00:00+00:00"><meta property="article:modified_time" content="2019-12-29T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cupsofcode.com/images/speakers.jpg"><meta name=twitter:title content="Good and sad examples of extension functions"><meta name=twitter:description content="Common practices of writing extension functions in Kotlin"><meta name=twitter:site content="@aida_isay"><meta data-name=palette content="brown"><link rel=stylesheet href=https://cupsofcode.com/css/bundle.min.c0634b2209dea5d6876106ad4156af8b48c56f092d70c73a0a5900e0c754e686.css integrity="sha256-wGNLIgnepdaHYQatQVavi0jFbwktcMc6ClkA4MdU5oY=" crossorigin=anonymous><script src=https://cupsofcode.com/js/bundle.min.49b5b199db6f7ed9a80462dc05d2fa95d1779547094d452354baa7665152764b.js integrity="sha256-SbWxmdtvftmoBGLcBdL6ldF3lUcJTUUjVLqnZlFSdks=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-154896629-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=mode-light><header><nav class="navbar navbar-expand-xl fixed-top"><div class=container><a href=https://cupsofcode.com/><img alt=Logo src=https://cupsofcode.com/images/cupsOfCode_banner_dark_text.png loading=lazy style=margin-left:.8rem;height:4rem;margin-top:-10px;margin-bottom:-8px;margin-right:10px></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-1 mb-2 mb-lg-0"><form class="search-bar d-flex ms-1" action=https://cupsofcode.com/search><div class="input-group input-group-sm"><button class="btn btn-search disabled position-absolute left-0" type=submit><i class="fas fa-fw fa-search"></i></button>
<input class="form-control rounded-pill" id=searchQuery name=q type=search aria-label=Search></div></form></ul><ul class="navbar-nav me-1 mb-2 mb-lg-0 me-1 ms-auto"><li class=nav-item><a class=nav-link href=https://cupsofcode.com/about>About</a></li><li class=nav-item><a class=nav-link href=https://cupsofcode.com/tools>Tools</a></li><li class=nav-item><a class=nav-link href=https://imp.i115008.net/jWQXNb target=_blank>Courses</a></li><li class=nav-item><a class=nav-link href=https://cupsofcode.com/talks>Talks</a></li><li class=nav-item><a class=nav-link href=https://www.theorganizeddev.com/ target=_blank>Templates</a></li><li class=nav-item><a class=nav-link href=https://cupsofcode.com/archives>Archives</a></li></ul></div></div></nav></header><main role=main class=container><div class="row content"><div class=col-lg-8><div class=container><nav class=row aria-label=breadcrumb><ol class="breadcrumb surface"><li class=breadcrumb-item><a href=https://cupsofcode.com/>Home</a></li><li class=breadcrumb-item><a href=https://cupsofcode.com/post/>Posts</a></li><li class="breadcrumb-item active">Good and Sad Examples of Extension Functions</li></ol></nav><article class="post row surface"><div class=post-panel-wrapper><div class="post-panel d-flex flex-column"><a class=action data-bs-container=body data-bs-toggle=popover data-bs-html=true data-bs-placement=bottom data-bs-trigger=focus tabindex=0 data-bs-content='<a target="_blank" rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.en">CC BY-NC-ND 4.0 <i class="fab fa-fw fa-creative-commons"></i><i class="fab fa-fw fa-creative-commons-by"></i><i class="fab fa-fw fa-creative-commons-nc"></i><i class="fab fa-fw fa-creative-commons-nd"></i></a>
'><i class="fas fa-fw fa-copyright"></i></a></div></div><h1 class="post-title my-3">Good and Sad Examples of Extension Functions</h1><div class="post-meta mb-3" style=word-break:break-word><span class="post-date me-2"><i class="fas fa-fw fa-calendar-alt"></i>Dec 29, 2019</span>
<span class="post-reading-time me-2"><i class="fas fa-fw fa-coffee"></i>5 min read
</span><a href=https://cupsofcode.com/categories/android-development/ class=post-button-tag>Android Development</a><a href=https://cupsofcode.com/tags/android/ class=post-button-tag>android</a><a href=https://cupsofcode.com/tags/kotlin/ class=post-button-tag>kotlin</a></div><div class="post-share mb-3"></div><div class="offcanvas offcanvas-end surface" tabindex=-1 id=offcanvasTOC aria-labelledby=offcanvasTOCLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasTOCLabel>Table Of Contents</h5><a role=button data-bs-dismiss=offcanvas aria-label=Close><span class="fas fa-2x fa-fw fa-times"></span></a></div><div class=offcanvas-body><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#extending-android-and-java-common-types-to-meet-business-logic>Extending android and java common types to meet business logic</a></li><li><a href=#modifying-members-of-an-extending-class>Modifying members of an extending class</a></li><li><a href=#using-the-same-name-as-a-member-function>Using the same name as a member function</a></li><li><a href=#extending-context-on-every-occasion>Extending context on every occasion</a></li><li><a href=#making-an-extension-function-out-of-a-nullable-receiver>Making an extension function out of a nullable receiver</a></li><li><a href=#adding-iterators-via-extension-functions>Adding iterators via extension functions</a></li><li><a href=#converting-from-one-interface-to-another>Converting from one interface to another</a></li></ul></li></ul></li></ul></nav></div></div><div class=imageArt style=max-width:100%><img style=max-width:100%;object-fit:contain src=https://cupsofcode.com/images/speakers.jpg></div><a></br></a><div class="post-content mb-3"><h2 id=this-article-is-based-off-my-talkhttpsaidaissayevagithubiotalks-at-droidcon-sf-this-year>This article is based off my <a href=https://aidaissayeva.github.io/talks/ target=_blank>talk</a>
at Droidcon SF this year.</h2><p>Kotlin is well-known for null-safety and extension functions features among android developers. <a href=https://kotlinlang.org/docs/reference/extensions.html target=_blank>Extension functions</a>
provide the ability to make new functionality of an extending class without making changes to it. In addition, the new functionality can be declared outside of the extending class. They&rsquo;re also very beneficial when you want to tweak an api that can&rsquo;t be modified.</p><p>Writing a good extension function comes with practice, and there are no universal rules on how or when to make them. Every developer declares the rules for themselves based on the business need of an app. But regardless of what the needs are, there are some rules I&rsquo;ve set for myself.</p><p><em><strong>Let&rsquo;s go over some sad examples of making extensions:</strong></em></p><h5 id=extending-android-and-java-common-types-to-meet-business-logic>Extending android and java common types to meet business logic</h5><p>This reasoning comes up as a quick solution for many of us. But down the road, it&rsquo;ll get dirty and unmanageable.<div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>fun</span> <span class=nf>CharSequence</span><span class=p>.</span><span class=n>toAnimal</span><span class=p>():</span> <span class=n>Animal</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>Animal</span><span class=p>(</span>
        <span class=n>id</span> <span class=p>=</span> <span class=k>this</span><span class=p>.</span><span class=n>toString</span><span class=p>(),</span>
        <span class=n>name</span> <span class=p>=</span> <span class=k>this</span><span class=p>.</span><span class=n>toString</span><span class=p>(),</span>
        <span class=n>logo</span> <span class=p>=</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
        <span class=n>isDomestic</span> <span class=p>=</span> <span class=k>false</span><span class=p>,</span>
        <span class=n>inRedList</span> <span class=p>=</span> <span class=k>false</span><span class=p>,</span>
        <span class=n>description</span> <span class=p>=</span> <span class=k>this</span><span class=p>.</span><span class=n>toString</span><span class=p>()</span>
    <span class=p>)</span>
<span class=p>}</span></code></pre></div></p><p>Instead I&rsquo;d recommend to separate business and common types. Extension functions are great for mapping business to business logic:<div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>fun</span> <span class=nf>WildAnimal</span><span class=p>.</span><span class=n>toAnimal</span><span class=p>():</span> <span class=n>Animal</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>Animal</span><span class=p>(</span>
        <span class=n>id</span> <span class=p>=</span> <span class=n>id</span><span class=p>,</span>
        <span class=n>name</span> <span class=p>=</span> <span class=n>name</span><span class=p>,</span>
        <span class=n>logo</span> <span class=p>=</span> <span class=n>logo</span><span class=p>,</span>
        <span class=n>isDomestic</span> <span class=p>=</span> <span class=k>false</span><span class=p>,</span>
        <span class=n>description</span> <span class=p>=</span> <span class=n>shortDescription</span><span class=p>,</span>
        <span class=n>inRedList</span> <span class=p>=</span> <span class=n>inRedList</span>
    <span class=p>)</span>
<span class=p>}</span></code></pre></div></p><p>or common to common:<div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=nd>@kotlin</span><span class=p>.</span><span class=k>internal</span><span class=p>.</span><span class=n>InlineOnly</span>
<span class=k>public</span> <span class=k>inline</span> <span class=k>fun</span> <span class=nf>String</span><span class=p>.</span><span class=n>toPattern</span><span class=p>(</span><span class=n>flags</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=m>0</span><span class=p>):</span> <span class=n>java</span><span class=p>.</span><span class=n>util</span><span class=p>.</span><span class=n>regex</span><span class=p>.</span><span class=n>Pattern</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>java</span><span class=p>.</span><span class=n>util</span><span class=p>.</span><span class=n>regex</span><span class=p>.</span><span class=n>Pattern</span><span class=p>.</span><span class=n>compile</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=n>flags</span><span class=p>)</span>
<span class=p>}</span></code></pre></div></p><h5 id=modifying-members-of-an-extending-class>Modifying members of an extending class</h5><p>Extension functions are meant to extend a class with new functionality, not to modify or insert members into it.</p><p><div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>fun</span> <span class=nf>MainActivity</span><span class=p>.</span><span class=n>showWhiteLoadingIndicator</span><span class=p>()</span> <span class=p>{</span>

    <span class=n>mNumActiveLoadingIndicators</span><span class=o>++</span>

    <span class=n>runOnUiThread</span> <span class=p>{</span>
       <span class=p>.</span> <span class=p>.</span> <span class=p>.</span>
    <span class=p>}</span>

<span class=p>}</span></code></pre></div>In the example above, extension function <code>showWhiteLoadingIndicator()</code> is incrementing a member of <code>MainActivity</code> <code>mNumActiveLoadingIndicators</code>.</p><div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>class</span> <span class=nc>MainActivity</span> <span class=p>:</span> <span class=n>AppCompatActivity</span><span class=p>()</span> <span class=p>{</span>

    <span class=k>var</span> <span class=py>mNumActiveLoadingIndicators</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=m>0</span>

<span class=p>}</span></code></pre></div><p>Although this might work and some developers do practice it, making an extension function out of it seems as an overhead to me. No one cancelled out regular member functions, which can help you achieve the same functionality in the end.</p><div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>class</span> <span class=nc>MainActivity</span> <span class=p>:</span> <span class=n>AppCompatActivity</span><span class=p>()</span> <span class=p>{</span>

     <span class=k>var</span> <span class=py>mNumActiveLoadingIndicators</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=m>0</span>

     <span class=k>fun</span> <span class=nf>showWhiteLoadingIndicator</span><span class=p>()</span> <span class=p>{</span>
         <span class=n>mNumActiveLoadingIndicators</span><span class=o>++</span>

         <span class=n>runOnUiThread</span> <span class=p>{</span>
            <span class=p>.</span> <span class=p>.</span> <span class=p>.</span>
         <span class=p>}</span>
     <span class=p>}</span></code></pre></div><h5 id=using-the-same-name-as-a-member-function>Using the same name as a member function</h5><p>This is not a sad example, more of a caution to developers, who are switching to Kotlin and trying out extension functions. When making an extension function, be careful with naming. If it matches a member function, and is applicable to given arguments, compiler will choose the member function over an extension function.</p><p><div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=nd>@RemotableViewMethod</span>
<span class=k>public</span> <span class=n>void</span> <span class=n>setBackgroundColor</span><span class=p>(</span><span class=nd>@ColorInt</span> <span class=n>int</span> <span class=n>color</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>mBackground</span> <span class=n>instanceof</span> <span class=n>ColorDrawable</span><span class=p>)</span> <span class=p>{</span>
        <span class=p>((</span><span class=n>ColorDrawable</span><span class=p>)</span> <span class=n>mBackground</span><span class=p>.</span><span class=n>mutate</span><span class=p>()).</span><span class=n>setColor</span><span class=p>(</span><span class=n>color</span><span class=p>);</span>
        <span class=n>computeOpaqueFlags</span><span class=p>();</span>
        <span class=n>mBackgroundResource</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
        <span class=n>setBackground</span><span class=p>(</span><span class=n>new</span> <span class=n>ColorDrawable</span><span class=p>(</span><span class=n>color</span><span class=p>));</span>
    <span class=p>}</span>
<span class=p>}</span></code></pre></div><code>setBackgroundColor(@ColorInt int color)</code> is a member function of <code>View</code> class in android, and it accepts argument of type <code>int</code>.
Now if we look at the below extension function, the name and argument type match the member function.</p><div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>fun</span> <span class=nf>View</span><span class=p>.</span><span class=n>setBackgroundColor</span><span class=p>(</span><span class=n>colorResId</span><span class=p>:</span> <span class=n>Int</span><span class=p>)</span> <span class=p>{</span>
     <span class=n>setBackgroundColor</span><span class=p>(</span>
         <span class=n>ContextCompat</span><span class=p>.</span><span class=n>getColor</span><span class=p>(</span>
             <span class=n>context</span><span class=p>,</span> <span class=n>colorResId</span>
         <span class=p>)</span>
     <span class=p>)</span>
 <span class=p>}</span></code></pre></div><p>Instead, the easiest solution will be to rename the extension function:</p><div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>fun</span> <span class=nf>View</span><span class=p>.</span><span class=n>setBackgroundColorResId</span><span class=p>(</span><span class=n>colorId</span><span class=p>:</span> <span class=n>Int</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>setBackgroundColor</span><span class=p>(</span>
        <span class=n>ContextCompat</span><span class=p>.</span><span class=n>getColor</span><span class=p>(</span>
            <span class=n>context</span><span class=p>,</span> <span class=n>colorId</span>
        <span class=p>)</span>
    <span class=p>)</span>
<span class=p>}</span></code></pre></div><h5 id=extending-context-on-every-occasion>Extending context on every occasion</h5><p>We have all heard that the best way to start converting your app to kotlin is by converting util or helper methods into extension functions. Most likely, those methods at some point require the context to be passed:<div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>public</span> <span class=n>static</span> <span class=n>void</span> <span class=n>showGif</span><span class=p>(</span><span class=n>String</span> <span class=n>url</span><span class=p>,</span> <span class=n>Context</span> <span class=n>context</span><span class=p>,</span> <span class=n>ImageView</span> <span class=n>imageView</span><span class=p>)</span> <span class=p>{</span>
  <span class=n>Glide</span><span class=p>.</span><span class=n>with</span><span class=p>(</span><span class=n>context</span><span class=p>).</span><span class=n>asGif</span><span class=p>()</span>
      <span class=p>.</span><span class=n>listener</span><span class=p>(</span><span class=n>new</span> <span class=n>RequestListener</span><span class=p>&lt;</span><span class=n>GifDrawable</span><span class=p>&gt;()</span> <span class=p>{</span>
        <span class=nd>@Override</span> <span class=k>public</span> <span class=n>boolean</span> <span class=n>onLoadFailed</span><span class=p>(</span><span class=nd>@Nullable</span> <span class=n>GlideException</span> <span class=n>e</span><span class=p>,</span> <span class=n>Object</span> <span class=n>model</span><span class=p>,</span>
            <span class=n>Target</span><span class=p>&lt;</span><span class=n>GifDrawable</span><span class=p>&gt;</span> <span class=n>target</span><span class=p>,</span> <span class=n>boolean</span> <span class=n>isFirstResource</span><span class=p>)</span> <span class=p>{</span>
          <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=nd>@Override</span> <span class=k>public</span> <span class=n>boolean</span> <span class=n>onResourceReady</span><span class=p>(</span><span class=n>GifDrawable</span> <span class=n>resource</span><span class=p>,</span> <span class=n>Object</span> <span class=n>model</span><span class=p>,</span>
            <span class=n>Target</span><span class=p>&lt;</span><span class=n>GifDrawable</span><span class=p>&gt;</span> <span class=n>target</span><span class=p>,</span> <span class=n>DataSource</span> <span class=n>dataSource</span><span class=p>,</span> <span class=n>boolean</span> <span class=n>isFirstResource</span><span class=p>)</span> <span class=p>{</span>
          <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
        <span class=p>}</span>
      <span class=p>})</span>
      <span class=p>.</span><span class=n>load</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
      <span class=p>.</span><span class=n>into</span><span class=p>(</span><span class=n>imageView</span><span class=p>);</span>
<span class=p>}</span></code></pre></div></p><p>And naturally, the first thought is to extend the context where the rest of parameters can be passed to it:<div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>fun</span> <span class=nf>Context</span><span class=p>.</span><span class=n>showGif</span><span class=p>(</span><span class=n>imageView</span><span class=p>:</span> <span class=n>ImageView</span><span class=p>,</span> <span class=n>url</span><span class=p>:</span> <span class=n>String</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Glide</span><span class=p>.</span><span class=n>with</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
        <span class=p>.</span><span class=n>asGif</span><span class=p>()</span>
        <span class=p>.</span><span class=n>listener</span><span class=p>(</span><span class=k>object</span> <span class=err>: </span><span class=nc>RequestListener</span><span class=p>&lt;</span><span class=n>GifDrawable</span><span class=p>&gt;</span> <span class=p>{</span>
            <span class=k>override</span> <span class=k>fun</span> <span class=nf>onLoadFailed</span><span class=p>(</span><span class=n>e</span><span class=p>:</span> <span class=n>GlideException</span><span class=p>?,</span> <span class=n>model</span><span class=p>:</span> <span class=n>Any</span><span class=p>?,</span>
                <span class=n>target</span><span class=p>:</span> <span class=n>Target</span><span class=p>&lt;</span><span class=n>GifDrawable</span><span class=p>&gt;?,</span><span class=n>isFirstResource</span><span class=p>:</span> <span class=n>Boolean</span>
            <span class=p>)</span> <span class=p>=</span> <span class=k>false</span>

            <span class=k>override</span> <span class=k>fun</span> <span class=nf>onResourceReady</span><span class=p>(</span><span class=n>resource</span><span class=p>:</span> <span class=n>GifDrawable</span><span class=p>?,</span> <span class=n>model</span><span class=p>:</span> <span class=n>Any</span><span class=p>?,</span>
                <span class=n>target</span><span class=p>:</span> <span class=n>Target</span><span class=p>&lt;</span><span class=n>GifDrawable</span><span class=p>&gt;?,</span> <span class=n>dataSource</span><span class=p>:</span> <span class=n>DataSource</span><span class=p>?,</span>
                <span class=n>isFirstResource</span><span class=p>:</span> <span class=n>Boolean</span>
            <span class=p>)</span> <span class=p>=</span> <span class=k>false</span>
        <span class=p>})</span>
        <span class=p>.</span><span class=n>load</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
        <span class=p>.</span><span class=n>into</span><span class=p>(</span><span class=n>imageView</span><span class=p>)</span>
<span class=p>}</span></code></pre></div></p><p>At first glance, compiler doesn’t give any errors, the code runs, and the same functionality is preserved. But if we look at the docs, we can see that the <code>ImageView</code> class already has a member function, that returns a type <code>Context</code>. Therefore we can retrieve context directly from it by extending <code>Imageview</code>:<div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>fun</span> <span class=nf>ImageView</span><span class=p>.</span><span class=n>asGif</span><span class=p>(</span><span class=n>url</span><span class=p>:</span> <span class=n>String</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Glide</span><span class=p>.</span><span class=n>with</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=n>context</span><span class=p>)</span>
        <span class=p>.</span><span class=n>asGif</span><span class=p>()</span>
        <span class=p>.</span><span class=n>listener</span><span class=p>(</span><span class=k>object</span> <span class=err>: </span><span class=nc>RequestListener</span><span class=p>&lt;</span><span class=n>GifDrawable</span><span class=p>&gt;</span> <span class=p>{</span>
            <span class=k>override</span> <span class=k>fun</span> <span class=nf>onLoadFailed</span><span class=p>(</span><span class=n>e</span><span class=p>:</span> <span class=n>GlideException</span><span class=p>?,</span> <span class=n>model</span><span class=p>:</span> <span class=n>Any</span><span class=p>?,</span>
                <span class=n>target</span><span class=p>:</span> <span class=n>Target</span><span class=p>&lt;</span><span class=n>GifDrawable</span><span class=p>&gt;?,</span> <span class=n>isFirstResource</span><span class=p>:</span> <span class=n>Boolean</span>
            <span class=p>)</span> <span class=p>=</span> <span class=k>false</span>

            <span class=k>override</span> <span class=k>fun</span> <span class=nf>onResourceReady</span><span class=p>(</span><span class=n>resource</span><span class=p>:</span> <span class=n>GifDrawable</span><span class=p>?,</span> <span class=n>model</span><span class=p>:</span> <span class=n>Any</span><span class=p>?,</span>
                <span class=n>target</span><span class=p>:</span> <span class=n>Target</span><span class=p>&lt;</span><span class=n>GifDrawable</span><span class=p>&gt;?,</span> <span class=n>dataSource</span><span class=p>:</span> <span class=n>DataSource</span><span class=p>?,</span>
                <span class=n>isFirstResource</span><span class=p>:</span> <span class=n>Boolean</span>
            <span class=p>)</span> <span class=p>=</span> <span class=k>false</span>
        <span class=p>})</span>
        <span class=p>.</span><span class=n>load</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
        <span class=p>.</span><span class=n>into</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
<span class=p>}</span></code></pre></div></p><p>Another case I commonly see is to extend context to display some other views:<div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>fun</span> <span class=nf>Context</span><span class=p>.</span><span class=n>showDialog</span><span class=p>(</span><span class=n>message</span><span class=p>:</span> <span class=n>String</span><span class=p>,</span> <span class=n>activity</span><span class=p>:</span> <span class=n>Activity</span><span class=p>?)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>activity</span> <span class=o>!=</span> <span class=k>null</span> <span class=o>&amp;&amp;</span> <span class=p>!</span><span class=n>activity</span><span class=p>.</span><span class=n>isFinishing</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>MaterialDialog</span><span class=p>.</span><span class=n>Builder</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
            <span class=p>.</span><span class=n>content</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
            <span class=p>.</span><span class=n>positiveText</span><span class=p>(</span><span class=s2>&#34;Ok&#34;</span><span class=p>)</span>
            <span class=p>.</span><span class=n>show</span><span class=p>()</span>
    <span class=p>}</span>
<span class=p>}</span></code></pre></div></p><p>Be aware, that by extending <code>Context</code>, you&rsquo;re letting every other context subclass that doesn&rsquo;t have access to <code>Window</code> class have the ability to call the extension function. For instance, you can access context inside service, therefore you can call <code>context.showDialog()</code>, but dialog needs to be drawn on window, that needs an access to content which lives on activity, therefore calling <code>showDialog()</code> in service will crash.</p><p><em><strong>Now about some good practices:</strong></em></p><h5 id=making-an-extension-function-out-of-a-nullable-receiver>Making an extension function out of a nullable receiver</h5><div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>public</span> <span class=k>actual</span> <span class=k>fun</span> <span class=nf>String</span><span class=o>?.</span><span class=n>equals</span><span class=p>(</span><span class=n>other</span><span class=p>:</span> <span class=n>String</span><span class=p>?,</span> <span class=n>ignoreCase</span><span class=p>:</span> <span class=n>Boolean</span> <span class=p>=</span> <span class=k>false</span><span class=p>):</span> <span class=n>Boolean</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=k>this</span> <span class=o>===</span> <span class=k>null</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>other</span> <span class=o>===</span> <span class=k>null</span>
    <span class=k>return</span> <span class=k>if</span> <span class=p>(!</span><span class=n>ignoreCase</span><span class=p>)</span>
        <span class=p>(</span><span class=k>this</span> <span class=k>as</span> <span class=n>java</span><span class=p>.</span><span class=n>lang</span><span class=p>.</span><span class=n>String</span><span class=p>).</span><span class=n>equals</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
    <span class=k>else</span>
        <span class=p>(</span><span class=k>this</span> <span class=k>as</span> <span class=n>java</span><span class=p>.</span><span class=n>lang</span><span class=p>.</span><span class=n>String</span><span class=p>).</span><span class=n>equalsIgnoreCase</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
<span class=p>}</span></code></pre></div><h5 id=adding-iterators-via-extension-functions>Adding iterators via extension functions</h5><p>This is a perfect example of extending a limited api:<div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>inline</span> <span class=k>fun</span> <span class=nf>Menu</span><span class=p>.</span><span class=n>forEach</span><span class=p>(</span><span class=n>action</span><span class=p>:</span> <span class=p>(</span><span class=n>item</span><span class=p>:</span> <span class=n>MenuItem</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Unit</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>for</span> <span class=p>(</span><span class=n>index</span> <span class=k>in</span> <span class=m>0</span> <span class=n>until</span> <span class=n>size</span><span class=p>())</span> <span class=p>{</span>
        <span class=n>action</span><span class=p>(</span><span class=n>getItem</span><span class=p>(</span><span class=n>index</span><span class=p>))</span>
    <span class=p>}</span>
<span class=p>}</span></code></pre></div></p><h5 id=converting-from-one-interface-to-another>Converting from one interface to another</h5><div class=highlight><pre class=chroma><code class=language-kt data-lang=kt><span class=k>public</span> <span class=k>fun</span> <span class=p>&lt;</span><span class=nc>K</span><span class=p>,</span> <span class=nc>V</span><span class=p>&gt;</span> <span class=nf>Map</span><span class=p>&lt;</span><span class=k>out</span> <span class=n>K</span><span class=p>,</span> <span class=n>V</span><span class=p>&gt;.</span><span class=n>asSequence</span><span class=p>():</span> <span class=n>Sequence</span><span class=p>&lt;</span><span class=n>Map</span><span class=p>.</span><span class=n>Entry</span><span class=p>&lt;</span><span class=n>K</span><span class=p>,</span> <span class=n>V</span><span class=p>&gt;&gt;</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>entries</span><span class=p>.</span><span class=n>asSequence</span><span class=p>()</span>
<span class=p>}</span></code></pre></div><p>It&rsquo;s important to structure extension functions properly. For example, I usually create a file that contains all extension functions of a receiver type. It&rsquo;s easy down the road for new developers in the team to not make duplicated functions, and also easy to copy a file from one project to another 😄 .</p><p>Code samples can be found <a href=https://github.com/AidaIssayeva/Level-up-your-extension-game target=_blank>here</a></p><p>Huge thanks to <a href=https://www.linkedin.com/in/eugeniolopez1/ target=_blank>Eugenio Lopez</a>
for being so patient and reviewing the article many times 🙏</p></div><hr><div class=post_buycoffee><p><b>❤️ Was this post helpful?</b></p><p>If you liked the article, give a shoutout to @aida_isay on
<a target=_blank href=https://www.instagram.com/aida_isay/><b>Instagram</b></a>, <a target=_blank href=https://www.threads.net/@aida_isay><b>Threads</b></a>,
or <a target=_blank href=https://twitter.com/Aida_Isay><b>Twitter</b></a>
and help share this article.</p><p>Thank you for your support 🙌</p></div><div style=margin-top:5px;margin-bottom:5px><a href="https://imp.i115008.net/c/2292842/912909/11298?subId1=CupsOfCode" target=_blank id=912909><img src=//a.impactradius-go.com/display-ad/11298-912909 style=max-width:100%></a><img height=0 width=0 src="https://imp.pxf.io/i/2292842/912909/11298?subId1=CupsOfCode" style=position:absolute;visibility:visible border=0></div><div class="post-navs d-flex mb-3 justify-content-between"><div class="post-nav w-50"><div class="prev-post btn btn-sm"><a href=https://cupsofcode.com/talks/>Talks</a></div></div><div class="post-nav flex-row-reverse"><div class="next-post btn btn-sm"><a href=https://cupsofcode.com/post/recap-of-2019/>Recap of 2019: The Art of Speaking</a></div></div></div><section class=related-posts><h3>Related Posts</h3><ul class=related-posts><li><a href=https://cupsofcode.com/talks/>Talks</a></li><li><a href=https://cupsofcode.com/about/>About Me</a></li><li><a href=https://cupsofcode.com/social/>Link in Bio</a></li></ul></section></article><div class="post-comments surface row"><script src=https://utteranc.es/client.js repo=AidaIssayeva/AidaIssayeva.github.io issue-term=pathname label theme=github-light crossorigin=anonymous async></script></div></div></div><aside class="col-lg-4 sidebar d-flex"><div class=container><section class="profile surface row text-center"><div class="col-12 d-flex align-items-center justify-content-center"><img class=profile-avatar src=https://cupsofcode.com/images/profile.jpg alt="Aida Issayeva" loading=lazy></div><div class=col-12><h5 class="profile-name my-2">Aida Issayeva</h5><div class="profile-bio mb-2">Software Engineer | Google Developer Expert in Android. I build and scale world-class mobile apps, and jot some thoughts on software, career, and personal development along the way.</div><div class=profile-meta><span class=profile-location><i class="fas fa-fw fa-map-marker-alt"></i>Jersey City</span><span class=profile-about><i class="fas fa-fw fa-info-circle"></i><a href=https://cupsofcode.com/about/>About Me</a></span></div></div></section><section class="recent-posts row surface"><h4>Recent Posts</h4><ul><li><a href=https://cupsofcode.com/post/day_9_one_effective_strategy_for-platform_engineers_to_showcase_impact_in_promotion_packets/>One Effective Strategy for Platform Engineers to Showcase Impact in Promotion Packets</a></li><li><a href=https://cupsofcode.com/post/day_8_the_one_software_app_i_cant_live_without_for_handling_my_life/>The One Software App I Can’t Live Without for Handling My Life</a></li><li><a href=https://cupsofcode.com/post/day_7_1_tip_i_would_give_someone_who_wants_to_become_a_software_engineer/>One Tip Every Junior Software Engineer Needs to Hear to Succeed</a></li><li><a href=https://cupsofcode.com/post/day_6_2_steps_for_android_developers_to_integrate_dependabot_under_10_minutes_and_automate_dependency_updates-copy/>2 Steps for Android Developers to Integrate Dependabot Under 10 Minutes and Automate Dependency Updates</a></li><li><a href=https://cupsofcode.com/post/day_5_3_realizations_about_task_management_to_finish_your_to-do_list_by_the_end_of_each_day/>3 Realizations About Task Management to Finish Your To-Do List by the End of Each Day</a></li></ul></section><section class="taxonomy-categories row surface"><h4><a href=https://cupsofcode.com/categories>Categories</a></h4><div><a href=https://cupsofcode.com/categories/android-development/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Android Development">Android Development <span class="badge rounded-pill">10</span>
</a><a href=https://cupsofcode.com/categories/ship-30-for-30/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Ship 30 for 30">Ship 30 for 30 <span class="badge rounded-pill">9</span>
</a><a href=https://cupsofcode.com/categories/personal/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Personal>Personal <span class="badge rounded-pill">8</span>
</a><a href=https://cupsofcode.com/categories/career/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Career>Career <span class="badge rounded-pill">5</span>
</a><a href=https://cupsofcode.com/categories/web-development/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Web Development">Web Development <span class="badge rounded-pill">2</span>
</a><a href=https://cupsofcode.com/categories/talks/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Talks>Talks <span class="badge rounded-pill">1</span>
</a><a href=https://cupsofcode.com/categories/tech-leadership/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Tech Leadership">Tech Leadership <span class="badge rounded-pill">1</span></a></div></section><section class="taxonomy-series row surface"><h4><a href=https://cupsofcode.com/series>Series</a></h4><div><a href=https://cupsofcode.com/series/recomposition/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Recomposition>Recomposition <span class="badge rounded-pill">1</span></a></div></section><section class="taxonomy-tags row surface"><h4><a href=https://cupsofcode.com/tags>Tags</a></h4><div><a href=https://cupsofcode.com/tags/android/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=android>android <span class="badge rounded-pill">8</span>
</a><a href=https://cupsofcode.com/tags/early-career/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="early career">early career <span class="badge rounded-pill">5</span>
</a><a href=https://cupsofcode.com/tags/jetpack-compose/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="jetpack compose">jetpack compose <span class="badge rounded-pill">3</span>
</a><a href=https://cupsofcode.com/tags/hugo/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=hugo>hugo <span class="badge rounded-pill">2</span>
</a><a href=https://cupsofcode.com/tags/web/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=web>web <span class="badge rounded-pill">2</span>
</a><a href=https://cupsofcode.com/tags/frameworks/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=frameworks>frameworks <span class="badge rounded-pill">1</span>
</a><a href=https://cupsofcode.com/tags/interview-process/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="interview process">interview process <span class="badge rounded-pill">1</span>
</a><a href=https://cupsofcode.com/tags/kotlin/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=kotlin>kotlin <span class="badge rounded-pill">1</span>
</a><a href=https://cupsofcode.com/tags/rx/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=rx>rx <span class="badge rounded-pill">1</span>
</a><a href=https://cupsofcode.com/tags/software-development/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="software development">software development <span class="badge rounded-pill">1</span></a></div></section></div></aside></div></main><footer class="footer mt-auto py-3 text-center container"><nav class="social-links nav my-2 justify-content-center"><li class=nav-item><a class="nav-link social-link" target=_blank href=https://github.com/AidaIssayeva title=GitHub rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-github"></i></a></li><li class=nav-item><a class="nav-link social-link" target=_blank href=https://www.instagram.com/aida_isay title=Instagram rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-instagram"></i></a></li><li class=nav-item><a class="nav-link social-link" target=_blank href=https://linkedin.com/in/aidaisay title=LinkedIn rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-linkedin-in"></i></a></li><li class=nav-item><a class="nav-link social-link" target=_blank href=https://www.tiktok.com/@aida_isay title=Tiktok rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-tiktok"></i></a></li><li class=nav-item><a class="nav-link social-link" target=_blank href=https://twitter.com/aida_isay title=Twitter rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-twitter"></i></a></li><li class=nav-item><a class="nav-link social-link" target=_blank href=https://www.youtube.com/channel/UCirX1GBbjqLkg7c7N-iIqOQ title=Youtube rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-youtube"></i></a></li></nav><div class="copyright mb-2">Copyright © 2024, Cups of Code</div></footer><a id=btnScrollToTop class=btn-scroll-to-top><i class="fas fa fa-chevron-circle-up fa-2x"></i></a></body></html>