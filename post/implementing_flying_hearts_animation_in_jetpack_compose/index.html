<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Flying Hearts Animation in Jetpack Compose: Quick and Easy Edition - Cups of Code</title><link rel=apple-touch-icon href=https://cupsofcode.com/images/favicons/logo.svg sizes=180x180><link rel=icon href=https://cupsofcode.com/images/favicons/logo.svg sizes=32x32 type=image/png><link rel=icon href=https://cupsofcode.com/images/favicons/logo.svg sizes=16x16 type=image/png><link rel=manifest href=https://cupsofcode.com/images/favicons/manifest.json><link rel=icon href=https://cupsofcode.com/images/favicons/logo.svg><meta name=keywords content><meta name=description content="The tutorial of Flying Hearts Animation in Android native UI toolkit, Jetpack Compose"><meta itemprop=name content="Flying Hearts Animation in Jetpack Compose: Quick and Easy Edition"><meta itemprop=description content="The tutorial of Flying Hearts Animation in Android native UI toolkit, Jetpack Compose"><meta itemprop=datePublished content="2022-03-01T00:00:00+00:00"><meta itemprop=dateModified content="2022-03-01T00:00:00+00:00"><meta itemprop=wordCount content="1463"><meta itemprop=image content="https://cupsofcode.com/images/flying_hearts_animation_in_jetpack_compose.jpg"><meta itemprop=keywords content="android,jetpack compose,"><meta property="og:title" content="Flying Hearts Animation in Jetpack Compose: Quick and Easy Edition"><meta property="og:description" content="The tutorial of Flying Hearts Animation in Android native UI toolkit, Jetpack Compose"><meta property="og:type" content="article"><meta property="og:url" content="https://cupsofcode.com/post/implementing_flying_hearts_animation_in_jetpack_compose/"><meta property="og:image" content="https://cupsofcode.com/images/flying_hearts_animation_in_jetpack_compose.jpg"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-03-01T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-01T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cupsofcode.com/images/flying_hearts_animation_in_jetpack_compose.jpg"><meta name=twitter:title content="Flying Hearts Animation in Jetpack Compose: Quick and Easy Edition"><meta name=twitter:description content="The tutorial of Flying Hearts Animation in Android native UI toolkit, Jetpack Compose"><meta name=twitter:site content="@aida_isay"><meta data-name=palette content="brown"><link rel=stylesheet href=https://cupsofcode.com/css/bundle.min.c0634b2209dea5d6876106ad4156af8b48c56f092d70c73a0a5900e0c754e686.css integrity="sha256-wGNLIgnepdaHYQatQVavi0jFbwktcMc6ClkA4MdU5oY=" crossorigin=anonymous><script src=https://cupsofcode.com/js/bundle.min.49b5b199db6f7ed9a80462dc05d2fa95d1779547094d452354baa7665152764b.js integrity="sha256-SbWxmdtvftmoBGLcBdL6ldF3lUcJTUUjVLqnZlFSdks=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-154896629-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=mode-light><header><nav class="navbar navbar-expand-xl fixed-top"><div class=container><a href=https://cupsofcode.com/><img alt=Logo src=https://cupsofcode.com/images/cupsOfCode_banner_dark_text.png loading=lazy style=margin-left:.8rem;height:4rem;margin-top:-10px;margin-bottom:-8px;margin-right:10px></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-1 mb-2 mb-lg-0"><form class="search-bar d-flex ms-1" action=https://cupsofcode.com/search><div class="input-group input-group-sm"><button class="btn btn-search disabled position-absolute left-0" type=submit><i class="fas fa-fw fa-search"></i></button>
<input class="form-control rounded-pill" id=searchQuery name=q type=search aria-label=Search></div></form></ul><ul class="navbar-nav me-1 mb-2 mb-lg-0 me-1 ms-auto"><li class=nav-item><a class=nav-link href=https://cupsofcode.com/about>About</a></li><li class=nav-item><a class=nav-link href=https://cupsofcode.com/tools>Tools</a></li><li class=nav-item><a class=nav-link href=https://imp.i115008.net/jWQXNb target=_blank>Courses</a></li><li class=nav-item><a class=nav-link href=https://cupsofcode.com/talks>Talks</a></li><li class=nav-item><a class=nav-link href=https://www.theorganizeddev.com/ target=_blank>Templates</a></li><li class=nav-item><a class=nav-link href=https://cupsofcode.com/archives>Archives</a></li></ul></div></div></nav></header><main role=main class=container><div class="row content"><div class=col-lg-8><div class=container><nav class=row aria-label=breadcrumb><ol class="breadcrumb surface"><li class=breadcrumb-item><a href=https://cupsofcode.com/>Home</a></li><li class=breadcrumb-item><a href=https://cupsofcode.com/post/>Posts</a></li><li class="breadcrumb-item active">Flying Hearts Animation in Jetpack Compose: Quick and Easy Edition</li></ol></nav><article class="post row surface"><div class=post-panel-wrapper><div class="post-panel d-flex flex-column"><a class=action data-bs-container=body data-bs-toggle=popover data-bs-html=true data-bs-placement=bottom data-bs-trigger=focus tabindex=0 data-bs-content='<a target="_blank" rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.en">CC BY-NC-ND 4.0 <i class="fab fa-fw fa-creative-commons"></i><i class="fab fa-fw fa-creative-commons-by"></i><i class="fab fa-fw fa-creative-commons-nc"></i><i class="fab fa-fw fa-creative-commons-nd"></i></a>
'><i class="fas fa-fw fa-copyright"></i></a></div></div><h1 class="post-title my-3">Flying Hearts Animation in Jetpack Compose: Quick and Easy Edition</h1><div class="post-meta mb-3" style=word-break:break-word><span class="post-date me-2"><i class="fas fa-fw fa-calendar-alt"></i>Mar 1, 2022</span>
<span class="post-reading-time me-2"><i class="fas fa-fw fa-coffee"></i>7 min read
</span><a href=https://cupsofcode.com/categories/android-development/ class=post-button-tag>Android Development</a><a href=https://cupsofcode.com/tags/android/ class=post-button-tag>android</a><a href=https://cupsofcode.com/tags/jetpack-compose/ class=post-button-tag>jetpack compose</a></div><div class="post-share mb-3"></div><div class="offcanvas offcanvas-end surface" tabindex=-1 id=offcanvasTOC aria-labelledby=offcanvasTOCLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasTOCLabel>Table Of Contents</h5><a role=button data-bs-dismiss=offcanvas aria-label=Close><span class="fas fa-2x fa-fw fa-times"></span></a></div><div class=offcanvas-body><nav id=TableOfContents><ul><li><a href=#1-drawing-the-heart-shape>1. Drawing the heart shape</a></li><li><a href=#2-introducing-the-state>2. Introducing the state</a></li><li><a href=#3-adding-visibility-animation>3. Adding Visibility animation</a></li><li><a href=#4-adding-position-animation>4. Adding Position animation</a></li><li><a href=#5-making-it-multiple>5. Making it multiple</a></li><li><a href=#6-additional-animations>6. Additional animations</a></li><li><a href=#7-clean-up>7. Clean up</a></li><li><a href=#8-whats-next>8. What’s next?</a></li></ul></nav></div></div><div class=imageArt style=max-width:100%><img style=max-width:100%;object-fit:contain src=https://cupsofcode.com/images/flying_hearts_animation_in_jetpack_compose.jpg></div><a></br></a><div class="post-content mb-3"><div><h4 style=margin-bottom:10px>Table Of Contents:</h4><nav id=TableOfContents><ul><li><a href=#1-drawing-the-heart-shape>1. Drawing the heart shape</a></li><li><a href=#2-introducing-the-state>2. Introducing the state</a></li><li><a href=#3-adding-visibility-animation>3. Adding Visibility animation</a></li><li><a href=#4-adding-position-animation>4. Adding Position animation</a></li><li><a href=#5-making-it-multiple>5. Making it multiple</a></li><li><a href=#6-additional-animations>6. Additional animations</a></li><li><a href=#7-clean-up>7. Clean up</a></li><li><a href=#8-whats-next>8. What’s next?</a></li></ul></nav></div><p><div class="alert alert-info" role=alert><i class="fas fa-fw fa-info-circle"></i>Featured in OnCreate Digest
<a href=https://www.oncreatedigest.com/issues/oncreate-digest-issue-98-1055899 target=_blank>Issue #98.</a></div><div class="alert alert-info" role=alert><i class="fas fa-fw fa-info-circle"></i>Featured in Android Weekly
<a href=https://androidweekly.net/issues/issue-508 target=_blank>Issue #508.</a></div><div class="alert alert-info" role=alert><i class="fas fa-fw fa-info-circle"></i>Featured in Jetpack Compose Resources
<a href=https://jetc.dev/issues/106.html target=_blank>Issue #106.</a></div></p><p>I find that the best way to learn anything is by replicating existing features. The flying hearts animation became quite popular when Instagram introduced a live-video feature. And I thought this could be a really good feature to practice animation in Jetpack Compose.<blockquote class=twitter-tweet><p lang=en dir=ltr>Implementing the flying hearts animation (from Instagram live videos) in <a href="https://twitter.com/hashtag/JetpackCompose?src=hash&ref_src=twsrc%5Etfw">#JetpackCompose</a><a href="https://twitter.com/hashtag/AndroidDev?src=hash&ref_src=twsrc%5Etfw">#AndroidDev</a> <a href=https://t.co/Wqi1PLuJJm>pic.twitter.com/Wqi1PLuJJm</a></p>&mdash; Aida Issayeva 🌻 (@Aida_Isay) <a href="https://twitter.com/Aida_Isay/status/1495181283907018758?ref_src=twsrc%5Etfw">February 19, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script>At first, it may seem like a complex animation, but if we look closer, for version 1 only two properties are used: visibility and the position of each heart.
In this tutorial, I’ll walk you through the implementation details of it, using the version <code>1.1.0-beta01</code> of Jetpack Compose.</p><h3 id=1-drawing-the-heart-shape>1. Drawing the heart shape</h3><p>In Jetpack Compose, there are multiple ways to apply a custom shape to a component. In the <a href=https://cupsofcode.com/post/jetpack_compose_comes_in_many_shapes_path_forms/>previous article</a>
, I wrote about leveraging the Shape API. In this one, I’ll use Canvas API to have precise control over what’s drawn on the screen.</p><blockquote><p>Note: Canvas API of Jetpack Compose still hits the view-based Canvas API under the hood. However, it provides a more developer-friendly interface and takes care of managing states, performance, etc.</p></blockquote><p>The new Canvas API exposes <code>DrawScope</code> , a scoped drawing environment that provides sizing information and different transformations. The biggest benefit of using <code>DrawScope</code> in the new API is there is no longer a need for maintaining the underlying state of the <code>Canvas</code> . This means that creating and updating the objects happens in one place.</p><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln> 1</span><span class=nd>@Composable</span>
<span class=ln> 2</span><span class=k>fun</span> <span class=nf>Heart</span><span class=p>()</span> <span class=p>{</span>
<span class=ln> 3</span>    <span class=n>Canvas</span><span class=p>(</span><span class=n>modifier</span> <span class=p>=</span> <span class=n>Modifier</span>
<span class=ln> 4</span>        <span class=p>.</span><span class=n>fillMaxSize</span><span class=p>(),</span>
<span class=ln> 5</span>        <span class=n>onDraw</span> <span class=p>=</span> <span class=p>{</span>
<span class=ln> 6</span>            <span class=k>val</span> <span class=py>path</span> <span class=p>=</span> <span class=n>Path</span><span class=p>().</span><span class=n>apply</span> <span class=p>{</span>
<span class=ln> 7</span>                <span class=n>heartPath</span><span class=p>(</span><span class=n>Size</span><span class=p>(</span><span class=m>120f</span><span class=p>,</span> <span class=m>120f</span><span class=p>))</span>
<span class=ln> 8</span>            <span class=p>}</span>
<span class=ln> 9</span>
<span class=ln>10</span>            <span class=n>drawPath</span><span class=p>(</span>
<span class=ln>11</span>                <span class=n>path</span> <span class=p>=</span> <span class=n>path</span><span class=p>,</span>
<span class=ln>12</span>                <span class=n>color</span> <span class=p>=</span> <span class=n>Color</span><span class=p>.</span><span class=n>Red</span><span class=p>,</span>
<span class=ln>13</span>            <span class=p>)</span>
<span class=ln>14</span>        <span class=p>}</span>
<span class=ln>15</span>    <span class=p>)</span>
<span class=ln>16</span><span class=p>}</span>
</code></pre></div><p>The heart path extension is available <a href=https://gist.github.com/AidaIssayeva/6646ed99c24ddbb79d883ecd50853590 target=_blank>here</a>
.</p><h3 id=2-introducing-the-state>2. Introducing the state</h3><p>For this animation, we have two states: <code>Show</code> and <code>Hide</code> .</p><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln>1</span><span class=k>enum</span> <span class=k>class</span> <span class=nc>HeartState</span> <span class=p>{</span>
<span class=ln>2</span>    <span class=n>Show</span><span class=p>,</span>
<span class=ln>3</span>    <span class=n>Hide</span>
<span class=ln>4</span><span class=p>}</span>
</code></pre></div><p>When the heart is shown, it will appear and move in the upward direction. When it’s in the hidden state, the heart disappears at the reached position.</p><p>The transition between states in the flying hearts is not fully user-controlled, the state change from <code>Show</code> to <code>Hide</code> happens automatically within a certain duration. To make that transition we’ll use <code>LaunchedEffect</code> to swap the states:</p><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln>1</span>    <span class=n>LaunchedEffect</span><span class=p>(</span><span class=n>key1</span> <span class=p>=</span> <span class=n>state</span><span class=p>,</span> <span class=n>block</span> <span class=p>=</span> <span class=p>{</span>
<span class=ln>2</span>        <span class=n>state</span><span class=p>.</span><span class=n>value</span> <span class=p>=</span> <span class=k>when</span> <span class=p>(</span><span class=n>state</span><span class=p>.</span><span class=n>value</span><span class=p>)</span> <span class=p>{</span>
<span class=ln>3</span>            <span class=n>HeartState</span><span class=p>.</span><span class=n>Show</span> <span class=o>-&gt;</span> <span class=n>HeartState</span><span class=p>.</span><span class=n>Hide</span>
<span class=ln>4</span>            <span class=n>HeartState</span><span class=p>.</span><span class=n>Hide</span> <span class=o>-&gt;</span> <span class=n>HeartState</span><span class=p>.</span><span class=n>Show</span>
<span class=ln>5</span>        <span class=p>}</span>
<span class=ln>6</span>    <span class=p>})</span>
</code></pre></div><h3 id=3-adding-visibility-animation>3. Adding Visibility animation</h3><p>Now with the state in place, we can start adding animations. The first property to animate is opacity, aka <code>alpha</code> in view-based and compose-based UI components. There are multiple ways to animate the appearance and disappearance of the element in Compose:</p><p>a) wrapping the element in high-level animation API <code>AnimatedVisibility</code>;</p><p>b) leveraging Modifier function <code>alpha</code> to set the visibility of the element;</p><p>c) using <code>alpha</code> parameter in <code>drawPath()</code> function to set the visibility of the <code>Path</code>.</p><p>I went with the <code>AnimatedVisibility</code> API.</p><p>When using AnimatedVisibility the entire content of the element will have the enter and exit animations. Under the hood, <code>AnimatedVisibility</code> creates a custom layout for the element and its content. Once the exit animation is completed, <code>AnimatedVisibility</code> removes the element and its content from the UI tree and then finally disposes.</p><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln>1</span>    <span class=n>AnimatedVisibility</span><span class=p>(</span>
<span class=ln>2</span>        <span class=n>visible</span> <span class=p>=</span> <span class=n>state</span><span class=p>.</span><span class=n>value</span> <span class=o>==</span> <span class=n>HeartState</span><span class=p>.</span><span class=n>Show</span><span class=p>,</span>
<span class=ln>3</span>        <span class=n>enter</span> <span class=p>=</span> <span class=n>fadeIn</span><span class=p>(</span><span class=n>animationSpec</span> <span class=p>=</span> <span class=n>tween</span><span class=p>(</span><span class=n>durationMillis</span> <span class=p>=</span> <span class=m>250</span><span class=p>)),</span>
<span class=ln>4</span>        <span class=n>exit</span> <span class=p>=</span> <span class=n>fadeOut</span><span class=p>(</span><span class=n>animationSpec</span> <span class=p>=</span> <span class=n>tween</span><span class=p>(</span><span class=n>durationMillis</span> <span class=p>=</span> <span class=m>700</span><span class=p>)),</span>
<span class=ln>5</span>    <span class=p>)</span> <span class=p>{</span>
<span class=ln>6</span>        <span class=n>Text</span><span class=p>(</span><span class=n>text</span> <span class=p>=</span> <span class=s2>&#34;This is a Text1&#34;</span><span class=p>)</span>
<span class=ln>7</span>        <span class=n>Text</span><span class=p>(</span><span class=n>text</span> <span class=p>=</span> <span class=s2>&#34;This is a Text2&#34;</span><span class=p>)</span>
<span class=ln>8</span>    <span class=p>}</span>
</code></pre></div><p>In the example above, both <code>Text</code>s will fade in at the same time and with the same easing.</p><p>In <code>AnimatedVisibility</code> only parameters <code>visible</code> and <code>content</code> are required. The parameters <code>enter</code>, <code>exit</code>, <code>modifier</code>, and <code>label</code> have default values. By default, the content appears by fading in and expanding, and it disappears by fading out and shrinking.</p><h3 id=4-adding-position-animation>4. Adding Position animation</h3><p>Now the next property to animate is the position of each heart. With each frame, the heart moves up.
Let’s refresh our knowledge of the canvas coordinates system: the top start corner of the screen has (0,0) coordinates, while the bottom end has (width, height) coordinates.
<img class=img-fluid src=/images/canvas_coordinates.png alt="Canvas Coordinates in Android Development" loading=lazy>
*The image is taken from <a href=https://twitter.com/hi_man_shoe target=_blank>@hi_man_shoe</a>
&rsquo;s article <a href=https://blog.mindorks.com/understanding-canvas-api-in-android target=_blank>&ldquo;Understanding Canvas API in Android&rdquo;</a>
.</p><p>Now for the movement of the heart, we need two coordinates: start (x,y) and end (x1, y1). Because the heart goes up, the start coordinate will be in the bottom half of the screen, while the end coordinate in the top half.</p><p>Let’s assume, for the start coordinate in X-axis, the animation will start at <code>width/2</code> , and in Y-axis it’ll start at <code>height - (bottomMargin + buttonHeight)</code>.</p><p>For the end coordinate, let’s calculate random values, using <code>Random</code> generator class:</p><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln>1</span><span class=k>val</span> <span class=py>yRandom</span> <span class=p>=</span> <span class=n>Random</span><span class=p>.</span><span class=n>nextInt</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>height</span> <span class=p>/</span> <span class=m>2</span><span class=p>)</span>
<span class=ln>2</span><span class=k>val</span> <span class=py>xRandom</span> <span class=p>=</span> <span class=n>Random</span><span class=p>.</span><span class=n>nextInt</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>width</span><span class=p>))</span>
</code></pre></div><p><code>yRandom</code> has a minimum value of zero, the top point of the screen, and a maximum value of <code>height / 2</code> , the vertical center of the screen.
<code>xRandom</code> has a minimum value of zero, the left point of the screen, and a maximum value of <code>width</code> , the right point of the screen.</p><p>As for animation, we can use low-level animation API <code>animate*AsState</code> function, specifically the <code>animateDpAsState()</code> :</p><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln>1</span>    <span class=k>val</span> <span class=py>offsetYAnimation</span><span class=p>:</span> <span class=n>Dp</span> <span class=k>by</span> <span class=n>animateDpAsState</span><span class=p>(</span>
<span class=ln>2</span>        <span class=n>targetValue</span> <span class=p>=</span> <span class=k>when</span> <span class=p>(</span><span class=n>state</span><span class=p>.</span><span class=n>value</span><span class=p>)</span> <span class=p>{</span>
<span class=ln>3</span>            <span class=n>HeartState</span><span class=p>.</span><span class=n>Show</span> <span class=o>-&gt;</span> <span class=n>height</span><span class=p>.</span><span class=n>dp</span>
<span class=ln>4</span>            <span class=k>else</span> <span class=o>-&gt;</span> <span class=n>yRandom</span>
<span class=ln>5</span>        <span class=p>},</span>
<span class=ln>6</span>        <span class=n>animationSpec</span> <span class=p>=</span> <span class=n>tween</span><span class=p>(</span><span class=m>1000</span><span class=p>)</span>
<span class=ln>7</span>    <span class=p>)</span>
</code></pre></div><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln>1</span>    <span class=k>val</span> <span class=py>offsetXAnimation</span><span class=p>:</span> <span class=n>Dp</span> <span class=k>by</span> <span class=n>animateDpAsState</span><span class=p>(</span>
<span class=ln>2</span>        <span class=n>targetValue</span> <span class=p>=</span> <span class=k>when</span> <span class=p>(</span><span class=n>state</span><span class=p>.</span><span class=n>value</span><span class=p>)</span> <span class=p>{</span>
<span class=ln>3</span>            <span class=n>HeartState</span><span class=p>.</span><span class=n>Show</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=n>width</span> <span class=p>/</span> <span class=m>2</span><span class=p>).</span><span class=n>dp</span>
<span class=ln>4</span>            <span class=k>else</span> <span class=o>-&gt;</span> <span class=n>xRandom</span><span class=p>.</span><span class=n>dp</span>
<span class=ln>5</span>        <span class=p>},</span>
<span class=ln>6</span>        <span class=n>animationSpec</span> <span class=p>=</span> <span class=n>tween</span><span class=p>(</span><span class=m>1000</span><span class=p>)</span>
<span class=ln>7</span>    <span class=p>)</span>
</code></pre></div><p>In <code>animate*Float/Color/Dp/Size/Offset/Rect/Int/IntSize/IntOffset*AsState</code> functions, only <code>targetValue</code> parameter is required, the rest have the default values.</p><p><code>animationSpec</code> stores:</p><ul><li><p>the data type to be animated;</p></li><li><p>the animation configuration, that will be used once the data has been converted to <a href=https://developer.android.com/reference/kotlin/androidx/compose/animation/core/AnimationVector target=_blank><code>AnimationVector</code></a>
.</p></li></ul><p>In the example above, I used <code>tween</code> spec with default <em><code>FastOutSlowInEasing</code></em>.</p><blockquote><p>It’s worth noting that <code>animate*AsState()</code> is perfect for animating a single value. To animate multiple values it’s better to use <code>updateTransition()</code> that will return the instance of Transition.
However, in this example, using transition gave me janky and earthquake-shaky animation.</p></blockquote><p>With the declared animation properties for the position, we can pass them to:</p><ul><li><p>the <code>translate()</code> function of the <code>Path</code> ;</p></li><li><p>the transformation function <code>translate()</code> of the <code>DrawScope</code> ;</p></li><li><p>modifier function <code>offset()</code> of the canvas.</p></li></ul><p>I chose the latter one:</p><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln>1</span>    <span class=n>Canvas</span><span class=p>(</span>
<span class=ln>2</span>        <span class=n>modifier</span> <span class=p>=</span> <span class=n>modifier</span>
<span class=ln>3</span>            <span class=p>.</span><span class=n>offset</span><span class=p>(</span><span class=n>y</span> <span class=p>=</span> <span class=n>offsetYAnimation</span><span class=p>,</span> <span class=n>x</span> <span class=p>=</span> <span class=n>offsetXAnimation</span><span class=p>)</span>
<span class=ln>4</span>    <span class=p>)</span>
</code></pre></div><h3 id=5-making-it-multiple>5. Making it multiple</h3><p>To make hearts appear on each click, we introduce the counter:</p><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln>1</span>    <span class=k>val</span> <span class=py>heartCount</span> <span class=p>=</span> <span class=n>remember</span> <span class=p>{</span> <span class=n>mutableStateOf</span><span class=p>(</span><span class=m>0</span><span class=p>)</span> <span class=p>}</span>
</code></pre></div><p>On each button click, we’ll increase the counter:</p><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln>1</span>    <span class=n>Button</span><span class=p>(</span>
<span class=ln>2</span>        <span class=n>onClick</span> <span class=p>=</span> <span class=p>{</span>
<span class=ln>3</span>            <span class=n>heartCount</span><span class=p>.</span><span class=n>value</span><span class=o>++</span>
<span class=ln>4</span>        <span class=p>}</span>
<span class=ln>5</span>    <span class=p>)</span>
</code></pre></div><p>Then wrap the canvas into Kotlin’s <code>repeat</code> inline function:</p><div class=highlight><pre class=chroma><code class=language-kotlin data-lang=kotlin><span class=ln>1</span>    <span class=n>repeat</span><span class=p>(</span><span class=n>heartCount</span><span class=p>.</span><span class=n>value</span><span class=p>)</span> <span class=p>{</span>
<span class=ln>2</span>        <span class=n>Heart</span><span class=p>()</span>
<span class=ln>3</span>    <span class=p>}</span>
</code></pre></div><h3 id=6-additional-animations>6. Additional animations</h3><p>The animation function <code>animate*Float/Color/Dp/Size/Offset/Rect/Int/IntSize/IntOffset*AsState</code> provides us out-of-the-box support for the extensive list of data types. We can introduce additional animation values and pass them to:</p><ul><li><p><code>DrawScope</code> ’s transformation functions like <code>translate</code> along the X and Y axes, <code>scale</code> in both vertical and horizontal directions, <code>rotate</code> to the current transform, etc.</p></li><li><p><code>DrawScope</code> ’s regular functions like <code>drawPath()</code>, <code>drawLine()</code> , <code>drawArc()</code> , <code>drawPoints()</code> , etc where we can leverage <code>color</code>, <code>alpha</code> , <code>sweepAngle</code> and many other parameters.</p></li><li><p><code>Modifier</code> ’s functions like <code>background()</code> , <code>size()</code> , <code>border()</code> , etc.</p></li></ul><h3 id=7-clean-up>7. Clean up</h3><p>After making the animations work, it’s time to modify the code and introduce parameters to the <code>Heart()</code> composable function.</p><ul><li><p>The first parameter is the <code>Modifier</code> to the Canvas component.</p></li><li><p>The second one is the horizontal padding for the left and right sides of the X-axis animation to narrow the horizontal axis for the shape swaying.</p></li><li><p>The third one is the bottom margin of the screen to determine the beginning of Y-axis animation.</p></li></ul><p>Additionally, we can introduce the duration of the animations and other parameters.</p><p>Full Code can be found <a href=https://gist.github.com/AidaIssayeva/772ce9bfb69267020e9f303c0951e6de target=_blank>here</a>
.</p><h3 id=8-whats-next>8. What’s next?</h3><p>After making the animation work, my view-based brain couldn’t stop but wonder about the performance of adding and removing the layout for every single heart. So I decided to optimize the code, and draw as many paths as the button clicked using the <code>repeat</code> function or simple for-loop inside <code>onDraw()</code> function of <code>Canvas</code>, but after days of trying to make it work, I figured it was time to take a nice break and write this article.</p><p>If you know the solution, please share it with me in the comments or on Twitter. Thank you so much!</p></div><hr><div class=post_buycoffee><p><b>❤️ Was this post helpful?</b></p><p>If you liked the article, give a shoutout to @aida_isay on
<a target=_blank href=https://www.instagram.com/aida_isay/><b>Instagram</b></a>, <a target=_blank href=https://www.threads.net/@aida_isay><b>Threads</b></a>,
or <a target=_blank href=https://twitter.com/Aida_Isay><b>Twitter</b></a>
and help share this article.</p><p>Thank you for your support 🙌</p></div><div style=margin-top:5px;margin-bottom:5px><a href="https://imp.i115008.net/c/2292842/912909/11298?subId1=CupsOfCode" target=_blank id=912909><img src=//a.impactradius-go.com/display-ad/11298-912909 style=max-width:100%></a><img height=0 width=0 src="https://imp.pxf.io/i/2292842/912909/11298?subId1=CupsOfCode" style=position:absolute;visibility:visible border=0></div><div class="post-navs d-flex mb-3 justify-content-between"><div class="post-nav w-50"><div class="prev-post btn btn-sm"><a href=https://cupsofcode.com/post/jetpack_compose_comes_in_many_shapes_path_forms/>Jetpack Compose in Many Shapes and Forms</a></div></div><div class="post-nav flex-row-reverse"><div class="next-post btn btn-sm"><a href=https://cupsofcode.com/post/history_of_hyphenation_in_android/>History of Hyphenation in Android</a></div></div></div><section class=related-posts><h3>Related Posts</h3><ul class=related-posts><li><a href=https://cupsofcode.com/post/jetpack_compose_comes_in_many_shapes_path_forms/>Jetpack Compose in Many Shapes and Forms</a></li><li><a href=https://cupsofcode.com/post/google_play_in-app_review_api_integration_mvi/>Integrating a Seamless In-App Review Rating Experience in MVI</a></li><li><a href=https://cupsofcode.com/post/when_how_use_rxjava_disposable_serialdisposable_compositedisposable/>When and How to Use RxJava Disposable</a></li><li><a href=https://cupsofcode.com/post/how-to-display-notification-in-2020/>How to Display Notifications in 2020</a></li><li><a href=https://cupsofcode.com/post/good-and-sad-extensions/>Good and Sad Examples of Extension Functions</a></li></ul></section></article><div class="post-comments surface row"><script src=https://utteranc.es/client.js repo=AidaIssayeva/AidaIssayeva.github.io issue-term=pathname label theme=github-light crossorigin=anonymous async></script></div></div></div><aside class="col-lg-4 sidebar d-flex"><div class=container><section class="profile surface row text-center"><div class="col-12 d-flex align-items-center justify-content-center"><img class=profile-avatar src=https://cupsofcode.com/images/profile.jpg alt="Aida Issayeva" loading=lazy></div><div class=col-12><h5 class="profile-name my-2">Aida Issayeva</h5><div class="profile-bio mb-2">Software Engineer | Google Developer Expert in Android. I build and scale world-class mobile apps, and jot some thoughts on software, career, and personal development along the way.</div><div class=profile-meta><span class=profile-location><i class="fas fa-fw fa-map-marker-alt"></i>Jersey City</span><span class=profile-about><i class="fas fa-fw fa-info-circle"></i><a href=https://cupsofcode.com/about/>About Me</a></span></div></div></section><section class="recent-posts row surface"><h4>Recent Posts</h4><ul><li><a href=https://cupsofcode.com/post/day_5_3_realizations_about_task_management_to_finish_your_to-do_list_by_the_end_of_each_day/>3 Realizations About Task Management to Finish Your To-Do List by the End of Each Day</a></li><li><a href=https://cupsofcode.com/post/day_4_how_i_got_interested_in_building_scalable_systems_for_my_life/>How I Got Interested in Building Scalable Systems for My Life</a></li><li><a href=https://cupsofcode.com/post/day_3_the_best_way_to_get_started_learning_about_android_development/>The Best Way to Get Started Learning About Android Development</a></li><li><a href=https://cupsofcode.com/post/day_2_3_essential_skills_that_define_a_software_engineer/>3 Essential Skills That Define a Software Engineer</a></li><li><a href=https://cupsofcode.com/post/day_1_why_i_m_starting_to_write_online_ship30for30/>Day 1: Why I'm Starting to Write Online</a></li></ul></section><section class="taxonomy-categories row surface"><h4><a href=https://cupsofcode.com/categories>Categories</a></h4><div><a href=https://cupsofcode.com/categories/android-development/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Android Development">Android Development <span class="badge rounded-pill">9</span>
</a><a href=https://cupsofcode.com/categories/personal/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Personal>Personal <span class="badge rounded-pill">7</span>
</a><a href=https://cupsofcode.com/categories/ship-30-for-30/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Ship 30 for 30">Ship 30 for 30 <span class="badge rounded-pill">5</span>
</a><a href=https://cupsofcode.com/categories/career/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Career>Career <span class="badge rounded-pill">3</span>
</a><a href=https://cupsofcode.com/categories/web-development/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Web Development">Web Development <span class="badge rounded-pill">2</span>
</a><a href=https://cupsofcode.com/categories/talks/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Talks>Talks <span class="badge rounded-pill">1</span>
</a><a href=https://cupsofcode.com/categories/tech-leadership/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="Tech Leadership">Tech Leadership <span class="badge rounded-pill">1</span></a></div></section><section class="taxonomy-series row surface"><h4><a href=https://cupsofcode.com/series>Series</a></h4><div><a href=https://cupsofcode.com/series/recomposition/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=Recomposition>Recomposition <span class="badge rounded-pill">1</span></a></div></section><section class="taxonomy-tags row surface"><h4><a href=https://cupsofcode.com/tags>Tags</a></h4><div><a href=https://cupsofcode.com/tags/android/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=android>android <span class="badge rounded-pill">8</span>
</a><a href=https://cupsofcode.com/tags/early-career/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="early career">early career <span class="badge rounded-pill">4</span>
</a><a href=https://cupsofcode.com/tags/jetpack-compose/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="jetpack compose">jetpack compose <span class="badge rounded-pill">3</span>
</a><a href=https://cupsofcode.com/tags/hugo/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=hugo>hugo <span class="badge rounded-pill">2</span>
</a><a href=https://cupsofcode.com/tags/web/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=web>web <span class="badge rounded-pill">2</span>
</a><a href=https://cupsofcode.com/tags/frameworks/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=frameworks>frameworks <span class="badge rounded-pill">1</span>
</a><a href=https://cupsofcode.com/tags/interview-process/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="interview process">interview process <span class="badge rounded-pill">1</span>
</a><a href=https://cupsofcode.com/tags/kotlin/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=kotlin>kotlin <span class="badge rounded-pill">1</span>
</a><a href=https://cupsofcode.com/tags/rx/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title=rx>rx <span class="badge rounded-pill">1</span>
</a><a href=https://cupsofcode.com/tags/software-development/ class="post-taxonomy rounded btn btn-sm me-2 mb-2" title="software development">software development <span class="badge rounded-pill">1</span></a></div></section></div></aside></div></main><footer class="footer mt-auto py-3 text-center container"><nav class="social-links nav my-2 justify-content-center"><li class=nav-item><a class="nav-link social-link" target=_blank href=https://github.com/AidaIssayeva title=GitHub rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-github"></i></a></li><li class=nav-item><a class="nav-link social-link" target=_blank href=https://www.instagram.com/aida_isay title=Instagram rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-instagram"></i></a></li><li class=nav-item><a class="nav-link social-link" target=_blank href=https://linkedin.com/in/aidaisay title=LinkedIn rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-linkedin-in"></i></a></li><li class=nav-item><a class="nav-link social-link" target=_blank href=https://www.tiktok.com/@aida_isay title=Tiktok rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-tiktok"></i></a></li><li class=nav-item><a class="nav-link social-link" target=_blank href=https://twitter.com/aida_isay title=Twitter rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-twitter"></i></a></li><li class=nav-item><a class="nav-link social-link" target=_blank href=https://www.youtube.com/channel/UCirX1GBbjqLkg7c7N-iIqOQ title=Youtube rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-youtube"></i></a></li></nav><div class="copyright mb-2">Copyright © 2024, Cups of Code</div></footer><a id=btnScrollToTop class=btn-scroll-to-top><i class="fas fa fa-chevron-circle-up fa-2x"></i></a></body></html>